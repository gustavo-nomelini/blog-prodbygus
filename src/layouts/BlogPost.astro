---
import { SITE_TITLE } from '../consts';
import Layout from './Layout.astro';

export interface Props {
	title: string;
	description: string;
	pubDate: Date;
	updatedDate?: Date;
	heroImage?: string;
	author?: string;
	tags?: string[];
}

const { 
	title, 
	description, 
	pubDate, 
	updatedDate, 
	heroImage = '/images/blog/default-hero.jpg',
	author = 'PRODBYGUS',
	tags = []
} = Astro.props;

const canonicalURL = new URL(Astro.url.pathname, Astro.site);
const fullTitle = `${title} | ${SITE_TITLE}`;
---

<Layout
	title={fullTitle}
	description={description}
	image={heroImage}
	ogType="article"
	publishedTime={pubDate.toISOString()}
	modifiedTime={updatedDate?.toISOString()}
>
	<div class="section-padding">
		<div class="mx-auto max-w-3xl">
			<p class="text-base/7 font-semibold text-[var(--primary)]">Blog</p>
			<h1 class="text-gradient mt-2 text-pretty text-4xl font-semibold tracking-tight sm:text-5xl">{title}</h1>
			<div class="mt-4 flex items-center gap-x-4 text-sm text-[var(--text-muted)]">
				<time datetime={pubDate.toISOString()}>
					{pubDate.toLocaleDateString('pt-BR', {
						year: 'numeric',
						month: 'long',
						day: 'numeric'
					})}
				</time>
				{updatedDate && (
					<>
						<span>•</span>
						<time datetime={updatedDate.toISOString()}>
							Atualizado em {updatedDate.toLocaleDateString('pt-BR', {
								year: 'numeric',
								month: 'long',
								day: 'numeric'
							})}
						</time>
					</>
				)}
				<span>•</span>
				<span>{author}</span>
			</div>
			{tags.length > 0 && (
				<div class="mt-4 flex flex-wrap gap-2">
					{tags.map(tag => (
						<a
							href={`/tags/${tag}`}
							class="relative z-10 rounded-full bg-[var(--surface)] px-3 py-1.5 font-medium text-[var(--text)] hover:bg-[var(--primary)] hover:text-[var(--background)] transition-colors"
						>
							{tag}
						</a>
					))}
				</div>
			)}
			<p class="mt-6 text-xl/8 text-[var(--text)]">{description}</p>
			{heroImage && (
				<figure class="mt-16">
					<img 
						class="aspect-video rounded-xl bg-[var(--surface)] object-cover shadow-lg shadow-[var(--primary)]/10" 
						src={heroImage} 
						alt={title} 
					/>
				</figure>
			)}
			<div class="mt-16 max-w-2xl prose prose-lg prose-invert prose-headings:text-[var(--primary)] prose-a:text-[var(--accent)] prose-blockquote:border-l-[var(--primary)] prose-blockquote:bg-surface-10 prose-blockquote:p-4 prose-blockquote:rounded-r-md prose-strong:text-[var(--highlight)] prose-code:text-[var(--highlight)] prose-pre:bg-[var(--surface)] prose-img:rounded-xl prose-img:shadow-md">
				<slot />
			</div>
		</div>
	</div>
</Layout>
